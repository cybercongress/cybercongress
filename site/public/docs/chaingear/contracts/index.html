<!DOCTYPE html>





<html lang="en" >

<head>
  
  
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>cyber•Congress</title>
<meta name="description" content="A peer-to-peer hypermedia protocol to make the web faster, safer, and more open." />
<meta name="author" content="cyber•Congress" />

  <link rel="canonical" href="../../../docs/chaingear/contracts/" />
  <link rel="alternate" href="../../../docs/chaingear/contracts/" hreflang="x-default">


<meta property="og:type" content="website" />
<meta property="og:description" content="A peer-to-peer hypermedia protocol to make the web faster, safer, and more open." />
<meta property="og:title" content="cyber•Congress" />
<meta property="og:site_name" content="cyber•Congress" />
<meta property="og:url" content="/docs/chaingear/contracts/" />
<meta property="og:locale" content="en_US">
<meta property="og:image" content="//img/ipfs-logo-256-ice.png" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" contentlogo="146" />
<meta property="og:image:height" content="166" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="cyber•Congress" />
<meta name="twitter:title" content="cyber•Congress" />
<meta name="twitter:creator" content="cyber•Congress" />
<meta name="twitter:description" content="A peer-to-peer hypermedia protocol to make the web faster, safer, and more open." />
<meta name="twitter:domain" content="https://cybercongress.ai" />
<meta name="twitter:image:src" content="//img/ipfs-logo-256-ice.png" />

<link rel="stylesheet" href="../../../css/main.css" />
<link rel="stylesheet" href="../../../highlight/github-gist.css" />
<link rel="stylesheet" href="../../../asciinema/asciinema-player.css" />

<link rel="shortcut icon" href="../../../img/favicon.png">
<link rel="alternate feed" href="../../../index.xml" type="application/rss+xml"  title="IPFS Blog" />

<script src="../../../asciinema/asciinema-player.js"></script>
<script src="../../../highlight/highlight.js"></script>
<script>hljs.initHighlightingOnLoad()</script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-52930282-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


</head>

<body id='docs'>
    <header class="header-has-logo" id="stars">
  <div class="container cf">
    <h1 class="pull-left logo margin-bottom">
      <a href="../../../" class="logo ipfs-logo transition transition-fadeout">cyber•Congress</a>
      <a href="../../../"><span class='logo-text'>cyber•Congress</span></a>
    </h1>
    <nav role="navigation" class="pull-right top-nav top-nav-dark cf">
      <input id="menu-toggle" type="checkbox" class="menu-toggle">
      <label for="menu-toggle"></label>
      <ul class="list-unstyled list-inline cf">
        <li><a href="../../../#propducts">Products</a></li>
        <li><a href="../../../#team" >Team</a></li>
        <li><a href="../../../docs/cyberd/cyberd/" >Docs</a></li>
        <li><a href="../../../post" >Blog</a></li>
      </ul>
    </nav>
    
  </div>
  <div class="view-more">
    <label>View more</label><a href="#"></a>
  </div>
</header>

    <header class="docs-header-mob align-center justify-between book-header">
  <label for="menu-control">
    <img src="../../../svg/menu.svg" alt="Menu" />
  </label>
  <strong>
  
    
    Contracts
  
</strong>
</header>

    
  <input type="checkbox" style="display: none" id="menu-control" />
  <main class="flex container docs">
    
    <aside class="book-menu fixed">
      <nav>
    <h2 class="book-brand logo">
  <a href="../../../" class="ipfs-logo transition transition-fadeout">cyber•Congress</a>
  <a href="../../../">cyber•Congress</a>
</h2>




  
  
  
  

  <style>
  nav ul a[href$="\2f docs\2f chaingear\2f contracts\2f "] {
      color: #36d6ae;
  }
  </style>

<ul>
<li><a href="../../../docs/chaingear/whitepaper/">Whitepaper</a></li>
</ul>





</nav>


  
<script>
(function() {
  var menu = document.querySelector('aside.book-menu nav')
  addEventListener('beforeunload', function(event) {
    localStorage.setItem('menu.scrollTop', menu.scrollTop)
  });
  menu.scrollTop = localStorage.getItem('menu.scrollTop')
})()
</script>



    </aside>

    <div class="book-page">
        <div class='project'>
            <a href="../../../docs/cyberd/cyberd/">cyber</a>
            <a href="../../../docs/cyb/dura/">cyb</a>
            <a href="../../../docs/chaingear/whitepaper/">chaingear</a>
            <a href="../../../docs/js-amino/overview/">js-amino</a>
          </div>
      
<article class="markdown">

<h1 id="contracts-overview">Contracts Overview</h1>

<h2 id="design-rationale">Design rationale</h2>

<p>Main design principle goes from ERC721 NFT tokenization of Databases (in Chaingear/Database of databases) and Entries (in custom user&rsquo;s Database).</p>

<p>In reason of Databases tokenization in Chaingear which allows token holder acts as administrator of their Databases, Chaingear acts to Database as owner, which sets token holder as administrator on creation phase, changes administrator when holder transfers token to another user, and transfers ownership when user unregister Database in Chaingear, giving them full control to contract. Database deep-linked to Chaingear database token. In other words, token ownership means control of Database. Also, Chaingear supports multiple Database Builders (fabrics of databases of given type), and allows Chaingear owners provide different kind and versioning of Databases.</p>

<p>In reason of providing user functionality to describe their custom database data structures/schema and CRUD operations, the user creates their custom smart-contract, which implements the ISchema interface. This contract acts as inner storage, defines schema, and Database acts them on token operations (creating and deleting). A user may deploy erroneous or vulnerable Schema contract, but this should not crash Chaingear-Database NFT-token logic and Database inner entry NFT-logic too. Even if this happens Database crashing should not affect Chaingear/metadatabase contract. We proceed from the premise that the creator of the database (administrator) is positive and it does not make sense for them to break his database by initializing it with an incorrect contract.</p>

<p>This brings us to tokenized (<strong>C</strong> <em>RU</em> <strong>D</strong>) operations (and inner in Schema) in Database and public (<em>C</em> <strong>R</strong> <em>UD</em>) plus tokenized (<em>CR</em> <strong>U</strong> <em>D</em>) Storage operation.</p>

<h2 id="chaingear-inheritance">Chaingear inheritance</h2>

<p><img src="../../../docs/chaingear/mermaid/contracts-chaingear_inheritance.svg" alt="chaingear_inheritance" /></p>

<h2 id="database-inheritance">Database inheritance</h2>

<p><img src="../../../docs/chaingear/mermaid/contracts-database_inheritance.svg" alt="database_inheritance" /></p>

<h3 id="chaingear">/chaingear</h3>

<ul>
<li><strong><em>Chaingear</em></strong> allows any user to create his own database.</li>
<li>Building fee is collecting by new database creation.</li>
<li>All builded databases are tokenized with ERC721 NFT token standard and saved in Chaingear metadatabase with db metainformation.</li>
<li>Creator of database may transfer tokenized ownership of database and destroy database with token burning.</li>
<li>Tokenized databases Entries may collect funds by users and Database&rsquo;s owner may claim them.</li>
<li>Chaingear supports multiple benefitiaries witch have access to collected fees from databases creation.</li>
<li>Also allows for owner add multiple database builders contracts based their on versioning or/and functionality.</li>
</ul>

<h3 id="builders">/builders</h3>

<ul>
<li><strong><em>DatabaseBuilder</em></strong> contains the code of specified version of Database. This code used by Chaingear for Database creation and deploy process. DatabaseBuilder should be added with specified version and description to Chaingear database&rsquo;s builders inner list. Chaingear contract should be added as allowed caller to DatabaseBuilder with reason to allow creation calls only by Chaingear contact.</li>
</ul>

<h3 id="common">/common</h3>

<ul>
<li><p><strong><em>Safe</em></strong> allows creator contract transfer ETHs to them and claim from, accounting logic holded by owner contract.</p></li>

<li><p><strong><em>IChaingear</em></strong></p></li>

<li><p><strong><em>IDatabase</em></strong></p></li>

<li><p><strong><em>IDatabaseBuilder</em></strong></p></li>

<li><p><strong><em>ISchema</em></strong></p></li>
</ul>

<h3 id="databases">/databases</h3>

<ul>
<li><p><strong><em>Database</em></strong> contract witch tokenize entries as NFT tokens via ERC721 standard. Users can create tokenized empty entries according to entry access policy setted in Database. Database provides tokenized (<strong>C</strong> <em>RU</em> <strong>D</strong>) actions, after creation of token and empty database object, user should initialize them (<em>CR</em> <strong>U</strong> <em>D</em>) in Storage. Also users can fund entries with ETHs which send to <em>DatabaseSafe</em> with which owner of entry token can claim funds.</p></li>

<li><p><strong><em>DatabaseAccessControl</em></strong> holds logic of controlling database and accessing to entries creation. Policy options to entries creation are OnlyAdministrator, Whitelist, AllUsers. Chaingear acts as owner of Database and creator of database acts of administrator with separated policies to Database functions.</p></li>
</ul>

<h3 id="schemas">/schemas</h3>

<ul>
<li><strong><em>Schema</em></strong> partially code-generated contract where database creator setup their custom entry structure and setters/getters. <em>Schema</em> then initializes in Database by their creator (as admin) and completes Database setup process. Provides public (<em>C</em> <strong>RU</strong> <em>D</em>) actions for users and inner (<strong>C</strong> <em>RU</em> <strong>D</strong>) tokenized actions for Database.  Database goes as owner of contract (and acts as proxy) with entries creating, token-based transferring and deleting.</li>
</ul>

<h4 id="entryinterface-interface-should-be-implemented-in-user-entrycore-contract">EntryInterface interface (should be implemented in user EntryCore contract)</h4>

<pre><code class="language-js">interface ISchema {

    function createEntry() external;
    function deleteEntry(uint256) external;
}
</code></pre>

<h4 id="example-schema">Example Schema</h4>

<pre><code class="language-js">pragma solidity 0.4.25;

import &quot;../common/ISchema.sol&quot;;
import &quot;../common/IDatabase.sol&quot;;
import &quot;openzeppelin-solidity/contracts/ownership/Ownable.sol&quot;;
import &quot;openzeppelin-solidity/contracts/introspection/SupportsInterfaceWithLookup.sol&quot;;


contract Schema is ISchema, Ownable, SupportsInterfaceWithLookup {
    
    bytes4 constant internal INTERFACE_SCHEMA_ID = 0x153366ed;

    struct Entry {
        string name;
        string manifest;
        string extension;
        string content;
        string logo;
    }
    
    Entry[] public entries;
    
    IDatabase internal database;
    
    constructor()
        public
    {
        _registerInterface(INTERFACE_SCHEMA_ID);
        database = IDatabase(owner);
    }
    
    function() external {} 
    
    function createEntry()
        external
        onlyOwner
    {
        Entry memory m = (Entry(
        {
            name:       &quot;&quot;,
            manifest:   &quot;&quot;,
            extension:  &quot;&quot;,
            content:    &quot;&quot;,
            logo:       &quot;&quot;
        }));

        entries.push(m);
    }
    
    function readEntry(uint256 _entryID)
        external
        view
        returns (
            string,
            string,
            string,
            string,
            string
        )
    {
        uint256 entryIndex = database.getIndexByID(_entryID);
        return (
            entries[entryIndex].name,
            entries[entryIndex].manifest,
            entries[entryIndex].extension,
            entries[entryIndex].content,
            entries[entryIndex].logo
        );
    }

    function updateEntry(
        uint256 _entryID,
        string  _name,
        string  _manifest,
        string  _extension,
        string  _content,
        string  _logo
    )
        external
    {
        database.auth(_entryID, msg.sender);
        
        uint256 entryIndex = database.getIndexByID(_entryID);
            
        Entry memory m = (Entry(
        {
            name:       _name,
            manifest:   _manifest,
            extension:  _extension,
            content:    _content,
            logo:       _logo
        }));
        entries[entryIndex] = m;
    }

    function deleteEntry(uint256 _entryIndex)
        external
        onlyOwner
    {        
        uint256 lastEntryIndex = entries.length - 1;
        Entry memory lastEntry = entries[lastEntryIndex];
        
        entries[_entryIndex] = lastEntry;
        delete entries[lastEntryIndex];
        entries.length--;
    }
    
}

</code></pre>
</article>

      

      
    </div>

    
  

  <aside class="book-toc level-3 fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#contracts-overview">Contracts Overview</a>
<ul>
<li><a href="#design-rationale">Design rationale</a></li>
<li><a href="#chaingear-inheritance">Chaingear inheritance</a></li>
<li><a href="#database-inheritance">Database inheritance</a>
<ul>
<li><a href="#chaingear">/chaingear</a></li>
<li><a href="#builders">/builders</a></li>
<li><a href="#common">/common</a></li>
<li><a href="#databases">/databases</a></li>
<li><a href="#schemas">/schemas</a>
<ul>
<li><a href="#entryinterface-interface-should-be-implemented-in-user-entrycore-contract">EntryInterface interface (should be implemented in user EntryCore contract)</a></li>
<li><a href="#example-schema">Example Schema</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>
  <footer role="contentinfo" class="footer-primary">
  <div class="container cf">
    <div class="cf">
      <div class="sitemap-menu grid-flex-container">
        <div class="grid-flex-cell">
          <ul class="sitemap list-unstyled">
            <li class="sitemap-head">cyber•Congress</li>
            <li><a href="https://cybercongress.ai/">about</a></li>
            <li><a href="https://github.com/cybercongress">github</a></li>
            <li><a href="https://github.com/cybercongress/cyb/blob/dev/README.md">agreement</a></li>
            <li><a href="https://mainnet.aragon.org/#/cyberfoundation.aragonid.eth/">cyber•Foundation</a></li>

          </ul>
        </div>
        <div class="grid-flex-cell">
          <ul class="sitemap list-unstyled">
            <li class="sitemap-head">cyber</li>
            <li><a href="https://cyberd.ai/">about</a></li>
            <li><a href="https://github.com/cybercongress/cyberd">github</a></li>
            <li><a href="https://github.com/cybercongress/cyberd/blob/master/docs/cyberd.md">whitepaper</a></li>
            <li><a href="https://t.me/fuckgoogle">devChat</a></li>
            <li><a href="#">forum</a></li>
          </ul>
        </div>
        <div class="grid-flex-cell">
          <ul class="sitemap list-unstyled">
            <li class="sitemap-head">cyb</li>
            <li><a href="https://cyb.ai/">about</a></li>
            <li><a href="https://github.com/cybercongress/cyb">github</a></li>
            <li><a href="https://github.com/cybercongress/cyb/releases">releases</a></li>
          </ul>
        </div>
        <div class="grid-flex-cell">
          <ul class="sitemap list-unstyled">
            <li class="sitemap-head">chaingear</li>
            <li><a href="https://cybercongress.github.io/chaingear/">about</a></li>
            <li><a href="https://github.com/cybercongress/chaingear">github</a></li>
          </ul>
        </div>
        <div class="grid-flex-cell">
          <ul class="sitemap list-unstyled">
            <li class="sitemap-head">Galt</li>
            <li><a href="https://galtproject.io/">about</a></li>
            <li><a href="https://github.com/galtspace">github</a></li>
            <li><a href="https://docs.galtproject.io/ru/">whitepaper</a></li>
          </ul>
        </div>
      </div>
      <div class="share-links">
        <ul class="share list-unstyled">
          
          <li><a class="Twitter" href="https://twitter.com/cyber_devs">Twitter</a></li>
          
          <li><a class="Telegram" href="https://t.me/fuckgoogle">Telegram</a></li>
          
          <li><a class="Reddit" href="https://www.reddit.com/r/cybercongress/">Reddit</a></li>
          
          <li><a class="Steemit" href="https://steemit.com/@cybercongress">Steemit</a></li>
          
          <li><a class="YouTube" href="https://www.youtube.com/channel/UCXgkFmGLhUcXSTp6d4cWEvg/featured">YouTube</a></li>
          
        </ul>
      </div>
    </div>
    <p class="footer-copyright center">© Cyber License. Don’t believe, don’t fear, don’t ask.</p>
  </div>
</footer>
  
  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-52930282-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>

</html>
